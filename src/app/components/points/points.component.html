<div class="background-container">
  <app-navbar></app-navbar>

  <div class="main-page">
    <!-- Header -->
    <!-- <div class="header">
            <div class="user-profile">
              <img src="../../../assets/images/human.png" alt="User Image" class="user-image">
              <i class="fa fa-bell bell-icon"></i>
            </div>
            <div class="header-icons">
              <i class="fa fa-cog"></i>
              <i class="fa fa-home"></i>
            </div>
          </div> -->

    <!-- Search and Filters -->
    <div class="search-and-filters">
      <div class="dropdown">
        <button class="btn btn-filter">
          <i class="fa-solid fa-circle-plus"></i>
          اضف طالب
        </button>
        <div class="dropdown-content">
          <a data-bs-toggle="modal" data-bs-target="#studentProfile"
            >أضف طالب يدوي</a
          >
          <a href="#">إضافة عن طريق إكسل</a>
        </div>
      </div>

      <div class="dropdown ">
        <button class="btn btn-filter" style="padding: 5px 35px;">تصدير</button>
        <div class="dropdown-content">
          <a href="#">PDF</a>
          <a href="#">Excel</a>
        </div>
      </div>

      <div class="dropdown ">
        <button class="btn btn-filter"><i class="fa-solid fa-chevron-down" style="padding-right: 5px;"></i>اخفاء اعمده</button>
        <!-- <div class="dropdown-content">
            <a href="#">PDF</a>
            <a href="#">Excel</a>
            </div> -->
      </div>

      <div class="search-container">
        <input type="text" class="search-bar" placeholder="بحث عن طالب" />
        <i class="fa fa-search search-icon"></i>
      </div>

      <div class="dropdown ms-2">
        <button class="btn btn-filter">
          <i class="fa-solid fa-sliders pe-2"></i>
          فلتر
        </button>
        <div class="dropdown-content">
          <a>فرز بحسب المركز</a>
          <a>فرز بحسب الاسم</a>
        </div>
      </div>
    </div>
    <div class="class-section-info container">
      <div class="row class-row">
        <div class="col-md-3 class-all m-3">
          <div class="class-info">
            <div class="container">
              <div class="row">
                <span class="class-text">عدد الطلاب</span>
              </div>
              <div class="row" style="justify-content: center;">
                <span class="class-value">{{ classData.classCount }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-3 class-all m-3">
          <div class="class-info">
            <div class="container">
              <div class="row">
                <span class="class-text">الفصل</span>
              </div>
              <div class="row" style="justify-content: center;">
                <span class="class-value">{{classData.className}}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3 class-all m-3">
          <div class="class-info">
            <div class="container">
              <div class="row">
                <span class="class-text">الصف</span>
              </div>
              <div class="row" style="justify-content: center;">
                <span class="class-value"> {{classData.gradeName}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Students List -->
    <div class="students-list">
      <div class="student-header">
        <div>
          <span class="student-header-head me-1"> النقاط</span>
        </div>

        <div class="student-icons">
          <span class="student-header-head">رقم الهاتف</span>
        </div>

        <div class="student-icons">
          <span class="student-header-head">كود الطالب</span>
        </div>

        <div class="student-info">
          <span class="student-header-head">معلومات الطالب</span>
        </div>

        <div class="student-icons">
          <span class="student-header-head">الرقم</span>
        </div>
      </div>
      <div class="student" *ngFor="let student of classData.students; let i = index">
        <div>
          <span class="student-grade me-1" 
            >100 / {{ student.totalPoints }}</span
          ><span >إجمالي النقاط</span>
        </div>

        <div class="student-info">
          <span class="student-name">{{ student.phoneNumber }}</span>
        </div>
        <div class="student-info">
          <span class="student-name">{{ student.code }}</span>
        </div>

        <div class="student-info" >
          <span class="student-name">{{ student.studentName }}</span>

          <!-- <img
            [src]="student.image"
            alt="Student Image"
            class="student-image"
          /> -->

    

          <div class="student-icons">
            <span class="badge">{{ i + 1 }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <div
  class="modal fade"
  id="Edit"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content outer-container">
      <div class="inner-container">
        <div class="modal-header">
          <h1 class="modal-title" id="staticBackdropLabel">السيرة الذاتية</h1>
          <button
            type="button"
            class="close closebtn"
            data-bs-dismiss="modal"
            aria-label="Close"
          >
            <img src="../../../assets/images/close.png" width="40px" />
          </button>
        </div>

        <div class="modal-footer">
          <button class="btn custombtn ms-4">حفظ</button>
        </div>

        <div class="modal-body">
          <div class="full-width-box custom-full-width-grid mt-3">
          </div>

          <div class="comment-box mt-4">
            <div class="comment-header">
              <button class="add-comment-btn">إضافة</button>
              <div class="stars-rating">
                <span class="rating-text ms-2">تقييم الدرس</span>
                <span class="stars">
                  <i class="fa-regular fa-star"></i>
                  <i class="fa-regular fa-star"></i>
                  <i class="fa-regular fa-star"></i>
                  <i class="fa-regular fa-star"></i>
                  <i class="fa-regular fa-star"></i>
                </span>
              </div>
            </div>

            <textarea
              class="comment-textarea"
              placeholder="قم بكتابة تعليق"
              rows="1"
            ></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> -->

<!-- Student Modal -->
<div class="modal fade" id="studentProfile" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content outer-container">
      <div class="inner-container">
        <div class="modal-header">
          <h1 class="modal-title" id="staticBackdropLabel">معلومات الطالب</h1>
          <button type="button" class="close closebtn" data-bs-dismiss="modal" aria-label="Close">
            <img src="../../../assets/images/close.png" width="40px" />
          </button>
        </div>
        <div class="modal-body full-width-box">
          <div class="container">
            <div class="row lineclass">
              <div class="col-md-12 align-items-center justify-content-center">
                <div class="user-img-container" (click)="fileInput.click()" *ngIf="studentFormType === 'new'">
                  <img [src]="userImage || '../../../assets/images/user-plus.png'" alt="User Image" class="user-img" />
                </div>
                <input #fileInput type="file" accept="image/*" (change)="onImageSelected($event)" style="display: none" />
                <button type="button" class="btn custombtn2"  [ngStyle]="{
                  backgroundColor: selectedFormType === 'existing' ? '#03556B' : '#F1E8BF',
                  color: selectedFormType === 'existing' ? 'white' : '#03556B',
                  border: selectedFormType === 'existing' ? 'none' : '1px solid #03556B'
                }" (click)="switchFormType('existing')" style="margin: 0px 9px 2px">تسجيل طالب موجود</button>

                <button type="button" class="btn custombtn2"  [ngStyle]="{
                  backgroundColor: selectedFormType === 'new' ? '#03556B' : '#F1E8BF',
                  color: selectedFormType === 'new' ? 'white' : '#03556B',
                  border: selectedFormType === 'new' ? 'none' : '1px solid #03556B'
                }" (click)="switchFormType('new')" style="margin: 0px 9px 2px">تسجيل طالب جديد</button>
              </div>
            </div>

            <!-- New Student Form -->
            <div *ngIf="studentFormType === 'new'">
              <form class="w-100 mt-4" [formGroup]="studentForm" (ngSubmit)="onSubmit()">
                <div class="row mb-3 justify-content-center">
                  <div class="col-md-6 text-right">
                    <label>الاسم الاول</label>
                    <input type="text" class="form-control rounded-pill" formControlName="firstName" />
                  </div>
                  <div class="col-md-6 float-right">
                    <label>الاسم الاخير</label>
                    <input type="text" class="form-control rounded-pill" formControlName="lastName" />
                  </div>
                </div>
                <div class="row mb-12 justify-content-center">
                  <div class="form-group mb-3 text-right">
                    <label class="label" for="phone">رقم الهاتف</label>
                    <div class="d-flex justify-content-between align-items-center">
                      <div class="d-flex align-items-center form-control rounded-pill" style="width: 110px">
                        <img src="https://flagcdn.com/24x18/sa.png" alt="KSA Flag" width="20" />
                        <span class="ml-2">+966</span>
                      </div>
                      <input type="text" class="form-control rounded-pill" id="phone" placeholder="اضف رقم الهاتف" required style="flex-grow: 1; margin-right: 10px" formControlName="phoneNumber" />
                    </div>
                  </div>
                </div>
                <div class="row mb-3 justify-content-center">
                  <div class="col-md-12 text-right">
                    <label>رقم الطالب</label>
                    <input type="text" class="form-control rounded-pill" formControlName="code" readonly  />
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn custombtn">حفظ</button>
                </div>
              </form>
            </div>

            <!-- Existing Student Form -->
            <div *ngIf="studentFormType === 'existing'">
              <form class="w-100 mt-4" [formGroup]="existForm" (ngSubmit)="onSubmit()">
                <div class="row mb-12 justify-content-center">
                  <div class="form-group mb-3 text-right">
                    <label class="label" for="phone">رقم الهاتف</label>
                    <div class="d-flex justify-content-between align-items-center">
                      <div class="d-flex align-items-center form-control rounded-pill" style="width: 110px">
                        <img src="https://flagcdn.com/24x18/sa.png" alt="KSA Flag" width="20" />
                        <span class="ml-2">+966</span>
                      </div>
                      <input type="text" class="form-control rounded-pill" id="phone" placeholder="اضف رقم الهاتف" required style="flex-grow: 1; margin-right: 10px" formControlName="studentPhoneNumber" />
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn custombtn">حفظ</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
